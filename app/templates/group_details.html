{% extends "base.html" %}

{% block content %}
    <h1>{{ group.name }}</h1>
    
    {% if current_role == 'admin' %}
        <p>
            <a href="{{ url_for('edit_group', group_id=group.id) }}">Edytuj nazwę grupy</a>
        </p>
    {% endif %}
    
    <h2>Członkowie grupy:</h2>
    <ul>
        {% for member_association in group.members %}
            <li>
                {{ member_association.user.email }}
                {% if member_association.role == 'admin' %}
                    <strong>(Administrator)</strong>
                {% endif %}
                
                {% if current_role == 'admin' and member_association.user.id != current_user.id %}
                    <form method="post" action="{{ url_for('remove_member', group_id=group.id, user_id=member_association.user.id) }}" style="display: inline;">
                        <button type="submit" onclick="return confirm('Czy na pewno chcesz usunąć tego użytkownika z grupy?');" style="color: red; background: none; border: none; cursor: pointer; font-size: 0.9em;">
                            [Usuń]
                        </button>
                    </form>
                {% endif %}
            </li>
        {% endfor %}
    </ul>
    
    {% if current_role == 'admin' %}
    <hr>
    <h2>Dodaj użytkownika do grupy</h2>
    <form action="" method="post">
        {{ form.hidden_tag() }}

        <p>
            {{ form.email.label }}<br>
            {{ form.email(size=32) }}
            {% if form.email.errors %}
                <ul style="color: red;">
                {% for error in form.email.errors %}
                    <li>{{ error }}</li>
                {% endfor %}
                </ul>
            {% endif %}
        </p>
        <p>{{ form.submit() }}</p>
    </form>
    {% endif %}
{% endblock %}